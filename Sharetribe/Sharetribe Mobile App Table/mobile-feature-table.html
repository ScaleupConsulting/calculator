<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pricing Table</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            padding: 20px;
        }
        
        .pricing-container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .pricing-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .pricing-header h1 {
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
        }
        
        .pricing-header p {
            font-weight: 400;
            color: #666;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .pricing-table {
            table-layout: fixed;
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            background-color: white;
            box-shadow: 0 5px 30px rgba(0, 0, 0, 0.08);
            border-radius: 12px;
            overflow: hidden;
        }
        
        .pricing-table th:first-child,
        .pricing-table td:first-child {
            width: 40%;
        }
        
        .pricing-table th:not(:first-child),
        .pricing-table td:not(:first-child) {
            width: 20%;
        }
        
        .pricing-table th, .pricing-table td {
            padding: 16px 15px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }
        
        .pricing-table th {
            background-color: #f8f9fa;
            font-weight: 500;
            color: #333;
            font-size: 15px;
        }
        
        .pricing-table tr:last-child td {
            border-bottom: none;
        }
        
        .pricing-table tr td:first-child {
            text-align: left;
            font-weight: 500;
            color: #333;
            padding-left: 25px;
            width: 30%;
        }
        
        .plan-header {
            background-color: #4a7aff;
            color: white;
            font-size: 18px;
            padding: 20px 15px !important;
            position: relative;
            overflow: hidden;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            font-weight: 500;
        }
        
        .plan-header::after {
            content: none;
        }
        
        .feature-row {
            transition: background-color 0.2s ease;
        }
        
        .feature-row:nth-child(even) {
            background-color: #f9fafc;
        }
        
        .feature-row:hover {
            background-color: #f0f4ff;
        }
        
        .availability-indicator {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 600;
            color: white;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            position: relative;
        }
        
        .availability-indicator:hover {
            transform: scale(1.15);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }
        
        .all-available {
            background-color: #2ecc71;
        }
        
        .some-available {
            background-color: #f39c12;
        }
        
        .none-available {
            background-color: #e74c3c;
        }
        
        .details-row {
            display: none;
            background-color: #f0f7ff;
        }
        
        .details-row.show {
            display: table-row;
        }
        
        .platform-row {
            height: 40px;
        }
        
        .platform-row td {
            padding: 8px 0;
            text-align: center;
            border-bottom: 1px solid #e0e5f5;
        }
        
        .platform-row td:first-child {
            text-align: left;
            padding-left: 25px;
            font-weight: 500;
        }
        
        .platform-row:last-child td {
            border-bottom: none;
        }
        
        .platform-status {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            font-size: 16px;
        }
        
        .status-available {
            color: #2ecc71;
        }
        
        .status-unavailable {
            color: #e74c3c;
        }
        
        .status-limited {
            color: #f39c12;
        }
        
        .status-mobile-web {
            background-color: transparent;
            color: #4a86e8;
            font-size: 16px;
        }
        
        .status-construction {
            background-color: transparent;
            color: #f6b26b;
            font-size: 16px;
        }
        
        .platform-detail {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }
        
        .platform-detail:last-child {
            margin-bottom: 0;
        }
        
        .platform-icon {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 600;
            color: white;
            margin-right: 8px;
        }
        
        .android-icon {
            background-color: #a4c639;
        }
        
        .ios-icon {
            background-color: #555;
        }
        
        .web-icon {
            background-color: #0078d7;
        }
        
        .legend {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 25px;
            padding: 20px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .legend-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        
        .legend-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }
        
        .legend-items {
            display: flex;
            gap: 15px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: #666;
        }
        
        .legend-icon {
            width: 16px;
            height: 16px;
            border-radius: 50%;
        }
        
        .platform-label {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            margin-bottom: 10px;
        }
        
        .platform-label-icon {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 600;
            color: white;
        }
        
        .android-label {
            background-color: #a4c639;
        }
        
        .ios-label {
            background-color: #555;
        }
        
        .web-label {
            background-color: #0078d7;
        }
        
        @media (max-width: 768px) {
            .pricing-table {
                font-size: 14px;
                border-radius: 8px;
            }
            
            .pricing-table th, .pricing-table td {
                padding: 12px 8px;
            }
            
            .plan-header {
                font-size: 16px;
                padding: 15px 8px !important;
            }
            
            .availability-indicator {
                width: 24px;
                height: 24px;
                font-size: 12px;
            }
            
            .legend {
                flex-direction: column;
                align-items: center;
                gap: 15px;
                padding: 15px;
            }
            
            .legend-section {
                width: 100%;
            }
        }
        
        /* Add indentation to platform names in details rows */
        .details-row td:first-child {
            padding-left: 40px !important;
            font-weight: 400;
            color: #555;
            font-size: 14px;
        }
        
        /* Keep the status indicators properly centered */
        .details-row td:not(:first-child) {
            text-align: center;
            vertical-align: middle;
        }
        
        /* Add a subtle left border to visually connect the platform rows to their parent */
        .details-row td:first-child {
            border-left: 3px solid #e0e5f5;
            padding-left: 37px !important;
        }
        
        /* Add a subtle background color difference */
        .details-row {
            background-color: #f8faff;
        }
        
        /* Add a mobile web icon class */
        .mobile-web-icon:before {
            content: "ÔøΩÔøΩ";
            font-size: 12px;
        }
        
        /* Update the construction icon */
        .construction-icon:before {
            content: "üõ†Ô∏è";
            font-size: 12px;
        }
        
        /* Add styles for the toggle icon */
        .toggle-icon {
            display: inline-block;
            margin-right: 8px;
            transition: transform 0.3s ease;
            font-size: 12px;
            color: #666;
        }
        
        /* Add the icon to feature rows */
        .feature-row td:first-child {
            position: relative;
            padding-left: 25px !important;
        }
        
        .feature-row td:first-child::before {
            content: "‚ñ∂";
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 10px;
            color: #888;
            transition: transform 0.3s ease;
        }
        
        /* Rotate the icon when expanded */
        .feature-row.expanded td:first-child::before {
            transform: translateY(-50%) rotate(90deg);
            color: #4a7aff;
        }
        
        /* Add tooltip styling */
        [data-tooltip] {
            position: relative;
            cursor: pointer;
        }
        
        [data-tooltip]::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            z-index: 10;
            pointer-events: none;
        }
        
        [data-tooltip]:hover::after {
            opacity: 1;
            visibility: visible;
        }
        
        /* Update the HTML for the availability indicators in collapsed view */
        .all-available, .some-available, .none-available {
            position: relative;
        }
        
        .all-available::after, .some-available::after, .none-available::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            z-index: 10;
            pointer-events: none;
        }
        
        .all-available:hover::after, .some-available:hover::after, .none-available:hover::after {
            opacity: 1;
            visibility: visible;
        }
        
        /* Update the HTML for the platform status in expanded view */
        .platform-status {
            position: relative;
        }
        
        .platform-status::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            z-index: 10;
            pointer-events: none;
        }
        
        .platform-status:hover::after {
            opacity: 1;
            visibility: visible;
        }
        
        /* Update tooltip handling for mobile devices */
        @media (max-width: 768px) {
            /* Change tooltip behavior for touch devices */
            [data-tooltip] {
                position: relative;
            }
            
            /* Make tooltips appear on tap instead of hover */
            [data-tooltip]::after {
                opacity: 0;
                visibility: hidden;
                transition: opacity 0.3s, visibility 0.3s;
                pointer-events: none;
                width: auto;
                max-width: 200px; /* Limit width on small screens */
                white-space: normal; /* Allow text to wrap */
                text-align: center;
            }
            
            /* Use JavaScript to toggle tooltip visibility on tap */
            [data-tooltip].tooltip-active::after {
                opacity: 1;
                visibility: visible;
            }
        }
        
        /* Add a mobile-only legend above the table */
        .mobile-legend {
            display: none; /* Hidden by default */
            text-align: center;
            margin-bottom: 15px;
            font-size: 13px;
            color: #666;
            padding: 8px;
            background-color: #f8f9ff;
            border-radius: 6px;
        }
        
        /* Only show on mobile */
        @media (max-width: 768px) {
            .mobile-legend {
                display: block; /* Show only on mobile */
            }
        }
        
        /* Update the HTML structure to remove expansion from specified rows */
        
        /* No Setup Fee - remove data-feature attribute and expansion arrow */
        .static-row td:first-child::before {
            content: none; /* Remove the expansion arrow */
        }
        
        .static-row {
            cursor: default; /* Remove the pointer cursor */
        }
        
        .static-row:hover {
            background-color: transparent; /* Remove hover effect */
        }
    </style>
</head>
<body>
    <div class="pricing-container">
        <div class="pricing-header">
            <p>Compare features across the different tiers to find the right one for you</p>
        </div>
        
        <div class="mobile-legend">
            Tap on icons <span style="font-size: 14px;">‚úì ‚úó ! üõ†Ô∏è</span> for more information
        </div>
        
        <table class="pricing-table">
            <thead>
                <tr>
                    <th>Features</th>
                    <th class="plan-header">Lite</th>
                    <th class="plan-header">Pro</th>
                    <th class="plan-header">Extend</th>
                </tr>
            </thead>
            <tbody>
                <!-- Table content will be generated dynamically from JSON data -->
            </tbody>
        </table>
        
        <div class="legend">
            <div class="legend-section">
                <div class="legend-title">Availability</div>
                <div class="legend-items">
                    <div class="legend-item">
                        <div class="legend-icon all-available">‚úì</div>
                        <span>Available</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-icon some-available">!</div>
                        <span>Limited</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-icon none-available">‚úó</div>
                        <span>Unavailable</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-icon">üõ†Ô∏è</div>
                        <span>Coming Soon</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Constants for availability types
        const AVAILABILITY = {
            ALL: "all",
            SOME: "some", 
            NONE: "none"
        };
        
        // Constants for platform status
        const STATUS = {
            AVAILABLE: "available",
            UNAVAILABLE: "unavailable",
            LIMITED: "limited",
            CONSTRUCTION: "construction"
        };
        
        // Constants for status symbols
        const SYMBOLS = {
            AVAILABLE: "‚úì",
            LIMITED: "!",
            UNAVAILABLE: "‚úó",
            CONSTRUCTION: "üõ†Ô∏è"
        };
        
        // Constants for platform names
        const PLATFORM = {
            ANDROID: "Android",
            IOS: "iOS",
            WEB: "Web",
            MOBILE_WEB: "Mobile Web"
        };
        
        // Common tooltip texts
        const TOOLTIP = {
            AVAILABLE_ANDROID: "Available on Android",
            AVAILABLE_IOS: "Available on iOS",
            AVAILABLE_WEB: "Available on Web",
            UNAVAILABLE: "Currently Unavailable",
            COMING_SOON_ANDROID: "Coming soon on Android",
            COMING_SOON_IOS: "Coming soon on iOS",
            COMING_SOON_WEB: "Coming soon on Web",
            NOT_AVAILABLE: "Not available",
            ALL_PLATFORMS: "Available on Android, iOS and Web"
        };

        // Define the pricing table data in JSON format
        const pricingData = {
            plans: [
                { name: "Lite", header: true },
                { name: "Pro", header: true },
                { name: "Extend", header: true }
            ],
            features: [
                {
                    name: "No Setup Fee",
                    static: true,
                    availability: [AVAILABILITY.ALL, AVAILABILITY.ALL, AVAILABILITY.ALL]
                },
                {
                    name: "No hidden fees or extra charges",
                    static: true,
                    availability: [AVAILABILITY.ALL, AVAILABILITY.ALL, AVAILABILITY.ALL]
                },
                {
                    name: "Email & Zoom Support",
                    static: true,
                    availability: [AVAILABILITY.ALL, AVAILABILITY.ALL, AVAILABILITY.ALL]
                },
                {
                    name: "Instant Updates",
                    static: true,
                    availability: [AVAILABILITY.ALL, AVAILABILITY.ALL, AVAILABILITY.ALL],
                    tooltip: TOOLTIP.ALL_PLATFORMS
                },
                {
                    name: "No App Store Reviews Necessary for Updates",
                    id: "app-store",
                    availability: [AVAILABILITY.ALL, AVAILABILITY.ALL, AVAILABILITY.SOME],
                    tooltip: [TOOLTIP.ALL_PLATFORMS, TOOLTIP.ALL_PLATFORMS, "Most updates"],
                    platforms: [
                        {
                            name: PLATFORM.ANDROID,
                            status: [STATUS.AVAILABLE, STATUS.AVAILABLE, STATUS.LIMITED],
                            tooltip: [TOOLTIP.AVAILABLE_ANDROID, TOOLTIP.AVAILABLE_ANDROID, "Most updates"]
                        },
                        {
                            name: PLATFORM.IOS,
                            status: [STATUS.AVAILABLE, STATUS.AVAILABLE, STATUS.LIMITED],
                            tooltip: [TOOLTIP.AVAILABLE_IOS, TOOLTIP.AVAILABLE_IOS, "Most updates"]
                        }
                    ]
                },
                {
                    name: "Tag Manager",
                    id: "tag-manager",
                    availability: [AVAILABILITY.SOME, AVAILABILITY.SOME, AVAILABILITY.ALL],
                    customTooltip: [
                        TOOLTIP.AVAILABLE_ANDROID, 
                        "Available on Android, iOS coming soon", 
                        TOOLTIP.ALL_PLATFORMS
                    ],
                    platforms: [
                        {
                            name: PLATFORM.ANDROID,
                            status: [STATUS.AVAILABLE, STATUS.AVAILABLE, STATUS.AVAILABLE],
                            tooltip: [TOOLTIP.AVAILABLE_ANDROID, TOOLTIP.AVAILABLE_ANDROID, TOOLTIP.AVAILABLE_ANDROID]
                        },
                        {
                            name: PLATFORM.IOS,
                            status: [STATUS.UNAVAILABLE, STATUS.CONSTRUCTION, STATUS.AVAILABLE],
                            tooltip: [TOOLTIP.UNAVAILABLE, TOOLTIP.COMING_SOON_IOS, TOOLTIP.AVAILABLE_ANDROID]
                        },
                        {
                            name: PLATFORM.WEB,
                            status: [STATUS.UNAVAILABLE, STATUS.UNAVAILABLE, STATUS.AVAILABLE],
                            tooltip: [TOOLTIP.UNAVAILABLE, TOOLTIP.UNAVAILABLE, TOOLTIP.AVAILABLE_WEB]
                        }
                    ]
                },
                {
                    name: "Push Notifications",
                    id: "push",
                    availability: [AVAILABILITY.NONE, AVAILABILITY.NONE, AVAILABILITY.ALL],
                    tooltip: [TOOLTIP.NOT_AVAILABLE, TOOLTIP.NOT_AVAILABLE, TOOLTIP.ALL_PLATFORMS],
                    platforms: [
                        {
                            name: PLATFORM.ANDROID,
                            status: [STATUS.UNAVAILABLE, STATUS.LIMITED, STATUS.AVAILABLE],
                            tooltip: [TOOLTIP.UNAVAILABLE, TOOLTIP.COMING_SOON_ANDROID, TOOLTIP.AVAILABLE_ANDROID]
                        },
                        {
                            name: PLATFORM.IOS,
                            status: [STATUS.UNAVAILABLE, STATUS.LIMITED, STATUS.AVAILABLE],
                            tooltip: [TOOLTIP.UNAVAILABLE, TOOLTIP.COMING_SOON_IOS, TOOLTIP.AVAILABLE_IOS]
                        },
                        {
                            name: PLATFORM.WEB,
                            status: [STATUS.UNAVAILABLE, STATUS.UNAVAILABLE, STATUS.AVAILABLE],
                            tooltip: [TOOLTIP.UNAVAILABLE, TOOLTIP.UNAVAILABLE, TOOLTIP.AVAILABLE_WEB]
                        }
                    ]
                },
                {
                    name: "Biometric Login",
                    id: "biometric",
                    availability: [AVAILABILITY.NONE, AVAILABILITY.NONE, AVAILABILITY.SOME],
                    tooltip: [TOOLTIP.NOT_AVAILABLE, TOOLTIP.NOT_AVAILABLE, "Available on Android and iOS"],
                    platforms: [
                        {
                            name: PLATFORM.ANDROID,
                            status: [STATUS.UNAVAILABLE, STATUS.UNAVAILABLE, STATUS.CONSTRUCTION],
                            tooltip: [TOOLTIP.UNAVAILABLE, TOOLTIP.UNAVAILABLE, TOOLTIP.COMING_SOON_ANDROID]
                        },
                        {
                            name: PLATFORM.IOS,
                            status: [STATUS.UNAVAILABLE, STATUS.LIMITED, STATUS.AVAILABLE],
                            tooltip: [TOOLTIP.UNAVAILABLE, TOOLTIP.COMING_SOON_IOS, TOOLTIP.AVAILABLE_IOS]
                        },
                        {
                            name: PLATFORM.WEB,
                            status: [STATUS.UNAVAILABLE, STATUS.UNAVAILABLE, STATUS.CONSTRUCTION],
                            tooltip: [TOOLTIP.UNAVAILABLE, TOOLTIP.UNAVAILABLE, TOOLTIP.COMING_SOON_WEB]
                        }
                    ]
                },
                {
                    name: "Deep Links",
                    id: "deep-links",
                    availability: [AVAILABILITY.NONE, AVAILABILITY.NONE, AVAILABILITY.SOME],
                    tooltip: [TOOLTIP.NOT_AVAILABLE, TOOLTIP.NOT_AVAILABLE, "Available on Android and iOS"],
                    platforms: [
                        {
                            name: PLATFORM.ANDROID,
                            status: [STATUS.UNAVAILABLE, STATUS.LIMITED, STATUS.AVAILABLE],
                            tooltip: [TOOLTIP.UNAVAILABLE, TOOLTIP.COMING_SOON_ANDROID, TOOLTIP.AVAILABLE_ANDROID]
                        },
                        {
                            name: PLATFORM.IOS,
                            status: [STATUS.UNAVAILABLE, STATUS.LIMITED, STATUS.AVAILABLE],
                            tooltip: [TOOLTIP.UNAVAILABLE, TOOLTIP.COMING_SOON_IOS, TOOLTIP.AVAILABLE_IOS]
                        }
                    ]
                },
                {
                    name: "Storage Access",
                    static: true,
                    availability: [AVAILABILITY.ALL, AVAILABILITY.ALL, AVAILABILITY.ALL],
                    tooltip: TOOLTIP.ALL_PLATFORMS
                },
                {
                    name: "Camera Access",
                    id: "camera",
                    availability: [AVAILABILITY.SOME, AVAILABILITY.SOME, AVAILABILITY.SOME],
                    tooltip: ["Available on Android and iOS", "Available on Android and iOS", "Available on Android and iOS"],
                    platforms: [
                        {
                            name: PLATFORM.ANDROID,
                            status: [STATUS.AVAILABLE, STATUS.AVAILABLE, STATUS.AVAILABLE],
                            tooltip: [TOOLTIP.AVAILABLE_ANDROID, TOOLTIP.AVAILABLE_ANDROID, TOOLTIP.AVAILABLE_ANDROID]
                        },
                        {
                            name: PLATFORM.IOS,
                            status: [STATUS.AVAILABLE, STATUS.AVAILABLE, STATUS.AVAILABLE],
                            tooltip: [TOOLTIP.AVAILABLE_IOS, TOOLTIP.AVAILABLE_IOS, TOOLTIP.AVAILABLE_IOS]
                        },
                        {
                            name: PLATFORM.WEB,
                            status: [STATUS.UNAVAILABLE, STATUS.UNAVAILABLE, STATUS.CONSTRUCTION],
                            tooltip: [TOOLTIP.UNAVAILABLE, TOOLTIP.UNAVAILABLE, TOOLTIP.COMING_SOON_WEB]
                        },
                        {
                            name: PLATFORM.MOBILE_WEB,
                            status: [STATUS.AVAILABLE, STATUS.AVAILABLE, STATUS.AVAILABLE],
                            tooltip: [TOOLTIP.AVAILABLE_WEB, TOOLTIP.AVAILABLE_WEB, TOOLTIP.AVAILABLE_WEB]
                        }
                    ]
                },
                {
                    name: "Geolocation",
                    static: true,
                    availability: [AVAILABILITY.ALL, AVAILABILITY.ALL, AVAILABILITY.ALL],
                    tooltip: TOOLTIP.ALL_PLATFORMS
                }
            ]
        };

        // Function to generate the pricing table HTML from JSON data
        function generatePricingTable(data) {
            const tableBody = document.querySelector('.pricing-table tbody');
            tableBody.innerHTML = ''; // Clear existing content
            
            // Generate rows for each feature
            data.features.forEach(feature => {
                // Create the main feature row
                const featureRow = document.createElement('tr');
                featureRow.className = feature.static ? 'static-row' : 'feature-row';
                
                if (!feature.static && feature.id) {
                    featureRow.setAttribute('data-feature', feature.id);
                }
                
                // Add feature name cell
                const nameCell = document.createElement('td');
                nameCell.textContent = feature.name;
                featureRow.appendChild(nameCell);
                
                // Add availability indicators for each plan
                for (let i = 0; i < data.plans.length; i++) {
                    const availabilityCell = document.createElement('td');
                    const indicator = document.createElement('div');
                    
                    // Set the appropriate class based on availability
                    indicator.className = `availability-indicator ${feature.availability[i]}-available`;
                    
                    // Set the appropriate symbol
                    if (feature.availability[i] === AVAILABILITY.ALL) {
                        indicator.textContent = SYMBOLS.AVAILABLE;
                    } else if (feature.availability[i] === AVAILABILITY.SOME) {
                        indicator.textContent = SYMBOLS.LIMITED;
                    } else {
                        indicator.textContent = SYMBOLS.UNAVAILABLE;
                    }
                    
                    // Set tooltip
                    if (feature.customTooltip && feature.customTooltip[i]) {
                        indicator.setAttribute('data-tooltip', feature.customTooltip[i]);
                        indicator.setAttribute('data-custom-tooltip', '');
                    } else if (feature.tooltip) {
                        if (Array.isArray(feature.tooltip)) {
                            indicator.setAttribute('data-tooltip', feature.tooltip[i]);
                        } else {
                            indicator.setAttribute('data-tooltip', feature.tooltip);
                        }
                    }
                    
                    availabilityCell.appendChild(indicator);
                    featureRow.appendChild(availabilityCell);
                }
                
                tableBody.appendChild(featureRow);
                
                // If the feature has platforms, create detail rows
                if (feature.platforms && !feature.static) {
                    feature.platforms.forEach(platform => {
                        const detailRow = document.createElement('tr');
                        detailRow.className = 'details-row';
                        detailRow.setAttribute('data-parent', feature.id);
                        
                        // Add platform name cell
                        const platformCell = document.createElement('td');
                        platformCell.textContent = platform.name;
                        detailRow.appendChild(platformCell);
                        
                        // Add status for each plan
                        for (let i = 0; i < data.plans.length; i++) {
                            const statusCell = document.createElement('td');
                            const statusSpan = document.createElement('span');
                            statusSpan.className = `platform-status status-${platform.status[i]}`;
                            
                            // Set the appropriate symbol
                            if (platform.status[i] === STATUS.AVAILABLE) {
                                statusSpan.textContent = SYMBOLS.AVAILABLE;
                            } else if (platform.status[i] === STATUS.UNAVAILABLE) {
                                statusSpan.textContent = SYMBOLS.UNAVAILABLE;
                            } else if (platform.status[i] === STATUS.LIMITED) {
                                statusSpan.textContent = SYMBOLS.LIMITED;
                            } else if (platform.status[i] === STATUS.CONSTRUCTION) {
                                statusSpan.textContent = SYMBOLS.CONSTRUCTION;
                            }
                            
                            // Set tooltip
                            if (platform.tooltip && platform.tooltip[i]) {
                                statusSpan.setAttribute('data-tooltip', platform.tooltip[i]);
                            }
                            
                            statusCell.appendChild(statusSpan);
                            detailRow.appendChild(statusCell);
                        }
                        
                        tableBody.appendChild(detailRow);
                    });
                }
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Generate the table from JSON data
            generatePricingTable(pricingData);
            
            // Only select feature rows, not static rows
            const featureRows = document.querySelectorAll('.feature-row');
            
            featureRows.forEach(row => {
                // Handle clicks on the entire row
                row.addEventListener('click', function(e) {
                    // Only proceed if the click wasn't on a tooltip element with stopPropagation
                    if (!e.target.closest('[data-tooltip]') || window.innerWidth > 768) {
                        toggleFeatureExpansion(this);
                    }
                });
                
                // Also handle clicks on the availability indicators in collapsed state
                const indicators = row.querySelectorAll('.availability-indicator');
                indicators.forEach(indicator => {
                    indicator.addEventListener('click', function(e) {
                        // For desktop, always toggle expansion
                        if (window.innerWidth > 768) {
                            // Prevent double-triggering from the row click
                            e.stopPropagation();
                            toggleFeatureExpansion(row);
                        }
                        // For mobile, only toggle expansion if not showing tooltip
                        // (tooltip handling is in the separate mobile section)
                    });
                });
            });
            
            // Function to toggle feature expansion
            function toggleFeatureExpansion(featureRow) {
                const featureId = featureRow.getAttribute('data-feature');
                const detailsRows = document.querySelectorAll(`.details-row[data-parent="${featureId}"]`);
                
                // Close all other detail rows
                document.querySelectorAll('.details-row.show').forEach(openRow => {
                    if (openRow.getAttribute('data-parent') !== featureId) {
                        openRow.classList.remove('show');
                        
                        // Find and update the corresponding feature row
                        const parentFeatureId = openRow.getAttribute('data-parent');
                        const parentFeatureRow = document.querySelector(`.feature-row[data-feature="${parentFeatureId}"]`);
                        if (parentFeatureRow) {
                            parentFeatureRow.classList.remove('expanded');
                        }
                    }
                });
                
                // Toggle these detail rows
                let anyShown = false;
                detailsRows.forEach(row => {
                    if (row.classList.contains('show')) {
                        anyShown = true;
                    }
                });
                
                detailsRows.forEach(row => {
                    if (anyShown) {
                        row.classList.remove('show');
                        featureRow.classList.remove('expanded');
                    } else {
                        row.classList.add('show');
                        featureRow.classList.add('expanded');
                    }
                });
            }
            
            // Mobile tooltip handling
            if (window.innerWidth <= 768) {
                const tooltipElements = document.querySelectorAll('[data-tooltip]');
                let activeTooltipTimeout;
                
                tooltipElements.forEach(el => {
                    el.addEventListener('click', function(e) {
                        // On mobile, we need to determine if this is a tooltip click or expansion click
                        const isAvailabilityIndicator = el.classList.contains('availability-indicator');
                        
                        // If it's an availability indicator (large icon in collapsed state)
                        if (isAvailabilityIndicator) {
                            // If a tooltip is already active, this click should close it and toggle expansion
                            if (document.querySelector('.tooltip-active')) {
                                document.querySelectorAll('.tooltip-active').forEach(activeTooltip => {
                                    activeTooltip.classList.remove('tooltip-active');
                                });
                                
                                // Clear any existing timeout
                                if (activeTooltipTimeout) {
                                    clearTimeout(activeTooltipTimeout);
                                }
                                
                                // Don't stop propagation - let the row click handler take over
                                return;
                            }
                            
                            // Otherwise, show the tooltip and prevent row expansion
                            e.stopPropagation();
                        } else {
                            // For other tooltips (in expanded state), always prevent propagation
                            e.stopPropagation();
                        }
                        
                        // Clear any existing timeout
                        if (activeTooltipTimeout) {
                            clearTimeout(activeTooltipTimeout);
                        }
                        
                        // Force immediate removal of any active tooltips
                        document.querySelectorAll('.tooltip-active').forEach(activeTooltip => {
                            void activeTooltip.offsetWidth;
                            activeTooltip.classList.remove('tooltip-active');
                        });
                        
                        // Show this tooltip
                        el.classList.add('tooltip-active');
                        
                        // Auto-hide after 2 seconds
                        activeTooltipTimeout = setTimeout(() => {
                            el.classList.remove('tooltip-active');
                        }, 2000);
                    });
                });
            }
        });
    </script>
</body>
</html>